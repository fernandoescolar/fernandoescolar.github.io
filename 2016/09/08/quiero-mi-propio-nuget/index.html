<!DOCTYPE html>
<html lang="es-es">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
		<title>
			Quiero mi propio NuGet · developerro
		</title>
		<!-- Social Metas -->
		<meta name="description" content="&#191;Recuerdas la primera vez que viste a John McClane? Nada m&#225;s llegar en avi&#243;n, le llevaron a la torre Nakatomi. La idea era recoger a Holly y llevarla de vuel..." />
		<meta property="og:title" content="Quiero mi propio NuGet" />
		<meta property="og:type" content="article" />
		<meta property="og:url" content="https://www.developerro.com/2016/09/08/quiero-mi-propio-nuget" />
		<meta property="og:image" content="https://www.developerro.com/assets/uploads/bg/diehard1.jpg" />
		<meta property="og:description" content="¿Recuerdas la primera vez que viste a John McClane? Nada más llegar en avión, le llevaron a la torre Nakatomi. La idea era recoger a Holly y llevarla de vuel..." />
		<meta property="og:site_name" content="developerro" />
		<meta property="og:locale" content="es_es" />
		<meta property="article:modified_time" content="2016-09-08 00:00:00Z" />
		<meta property="article:published_time" content="2016-09-08 00:00:00Z" />
		<meta property="article:author" content="Fernando Escolar" />
		<meta property="og:see_also" content="https://www.developerro.com/2021/03/24/azure-functions-net-5" />
		<meta property="og:see_also" content="https://www.developerro.com/2021/03/10/efcore-vs-records" />
		<meta property="og:see_also" content="https://www.developerro.com/2021/03/03/chorra-tip-1-wcd-command" />
		<meta name="twitter:card" content="summary" />
		<meta name="twitter:site" content="@fernandoescolar" />
		<meta name="twitter:creator" content="@fernandoescolar" />
		<meta name="twitter:title" content="Quiero mi propio NuGet" />
		<meta name="twitter:description" content="¿Recuerdas la primera vez que viste a John McClane? Nada más llegar en avión, le llevaron a la torre Nakatomi. La idea era recoger a Holly y llevarla de vuel..." />
		<meta name="twitter:image" content="https://www.developerro.com/assets/uploads/bg/diehard1.jpg" />
		<meta name="twitter:url" content="https://www.developerro.com/2016/09/08/quiero-mi-propio-nuget" />
		<meta name="description" content="¿Recuerdas la primera vez que viste a John McClane? Nada más llegar en avión, le llevaron a la torre Nakatomi. La idea era recoger a Holly y llevarla de vuel..." />
		<link rel="alternate" type="application/atom+xml" title="Developerro" href="/atom.xml" />
		<link rel="canonical" href="https://www.developerro.com/2016/09/08/quiero-mi-propio-nuget" />
		<!-- Icons -->
		<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png" />
		<link rel="shortcut icon" href="/assets/favicon.ico" />
		<!-- RSS -->
		<link rel="alternate" type="application/rss+xml" title="Developerro" href="/atom.xml" />
		<!-- Styles -->
		<link href="https://fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet" type="text/css" />
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" type="text/css" />
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" type="text/css" />
		<link rel="stylesheet" href="/assets/vendor/fontawesome-free/css/all.min.css" />
		<link rel="stylesheet" href="/assets/main.css" />
		<link rel="stylesheet" href="/assets/syntax.css" />
		<!-- Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-163390000-1">
		</script>
		<script>
			
			    function activateGoogleAnalytics() {
			        window.dataLayer = window.dataLayer || [];
			        function gtag(){dataLayer.push(arguments);}
			        gtag('js', new Date());
			        gtag('config', 'UA-163390000-1');
			    }
			
		</script>
		<style>
			
			    header { background: linear-gradient(to bottom, rgba(228, 225, 216, 0.95) 0%, rgba(172, 65, 66, 0.55) 100%), url(/assets/uploads/bg/diehard1.jpg) center / cover; }
			  
		</style>
	</head>
	<body>
		<nav>
			<i id="hamburger">
			</i> <a href="/">
				<b>
					d</b>eveloperro
			</a>
			<ul>
				<li>
					<a href="/posts">blog
					</a>
				</li>
				<li>
					<a href="/about">
						acerca de
					</a>
				</li>
				<li>
					<a href="/archive">
						archivo
					</a>
				</li>
				<li>
					<a href="/projects">
						oss
					</a>
				</li>
				<li>
					<a href="/search">
						buscar
					</a>
				</li>
				<li>
					<a href="/videos">
						vídeos
					</a>
				</li>
			</ul>
		</nav>
		<header class="post">
			<h1>
				Quiero mi propio NuGet
			</h1><small>08 sep. 2016 · 7 min. de lectura
			</small>
		</header>
		<article class="post">
			<p>
				¿Recuerdas la primera vez que viste a John McClane? Nada más llegar en avión, le llevaron a la torre Nakatomi. La idea era recoger a Holly y llevarla de vuelta a casa. En navidad. Todo era estupendo. Hasta Allen disfrutaba de un día tranquilo. Pero un maldito bastardo llamado Hans tuvo que venir a joder el cotarro.
				<!--break-->
			</p>
			<p>
				Esta misma situación nos la encontramos a diario en el mundo del desarrollo. Y generalmente terminamos llamando al John McClane de turno, para que nos solucione el fregao.
			</p>
			<p>
				La historia comienza con un cliente (<em>Holly
				</em>). Tiene una librería que se usa en muchos proyectos. Y esta librería o bien se copia a mano o bien se copia todo el código fuente de solución en solución (<em>Hans
				</em>). Nos encontramos en la tesitura de tener que añadir una funcionalidad nueva a esta librería (<em>Proyecto Nakatomi
				</em>). Y a la hora de actualizar todos los proyectos es cuando nos encontramos los problemas (<em>Navidad
				</em>). La única solución será usar un gestor de paquetes versionados que contengan esta librería. Pero no podemos usar el gestor de paquetes por defecto, ya que nos obligaría a publicar para todo el mundo este ensamblado. Así que decidimos montar un servidor de NuGet interno (<em>John McClane
				</em>).
			</p>
			<p>
				Existen varias alternativas a esto, como servicios tipo MyGet. Pero entonces esto no sería una jungla de cristal...
			</p>
			<h2 id="como-me-hago-un-nuget.server">
				¿Cómo me hago un NuGet.Server?
			</h2>
			<p>
				No es la primera vez que me encuentro en disposición de <del>hacer un John McClane
				</del> instalar un servidor de NuGet. Recuerdo bien los pasos. Es muy sencillo: Creas una aplicación Web vacía con Visual Studio. Buscas el paquete de NuGet llamado "NuGet.Server". Lo instalas. Cambias un par de parámetros de configuración. Y a publicar.
			</p>
			<p>
				Así que me pongo manos a la obra. Completo todos los pasos. Compilo. Falla (se rompen las ventanas dejando los trozos de cristal a mi lado, y yo descalzo).
			</p>
			<p>
				Buscando la solución no tardamos en encontrar la <a href="https://github.com/NuGet/NuGet.Server" title="NuGet.Server on GitHub">web del proyecto
				</a>. Ahora hospedado en github y bajo el manto protector del equipo de Open Source de Microsoft ("<em>Ahora tengo una ametralladora, Jo Jo Jo
				</em>").
			</p>
			<p>
				A partir de aquí dos caminos se abren. Pero solo se puede elegir uno:
			</p>
			<h3 id="bajar-por-el-hueco-de-los-ascensores">
				Bajar por el hueco de los ascensores
			</h3>
			<p>
				Aprovechando que conocemos la web con el código fuente: <a href="https://github.com/NuGet/NuGet.Server">https://github.com/NuGet/NuGet.Server
				</a>. Solo tenemos que seleccionar la rama estable de "release":
			</p>
			<p>
				<img src="/assets/uploads/2016/09/github-nuget-1.png" alt="Nuget.Server " relase branch />
			</p>
			<p>
				Después buscamos el enlace para descargar el código en forma de archivo zip:
			</p>
			<p>
				<img src="/assets/uploads/2016/09/github-nuget-2.png" alt="GitHub download repository as zip" />
			</p>
			<p>
				Y una vez finalizada la descarga, descomprimimos el archivo.
			</p>
			<h3 id="usar-el-conducto-de-la-ventilacion">
				Usar el conducto de la ventilación
			</h3>
			<p>
				El camino complejo pero seguro, consiste en abrir un terminal, bash o consola. Ahí nos <em>pelearemos
				</em> con comandos Git (<em>Terroristas
				</em>):
			</p>
			<pre class="language-bash highlight">
<code># clonamos el repositorio en la carpeta nuget-server
$ git clone https://github.com/NuGet/NuGet.Server.git nuget-server
				</code>
</pre>
			<p>
				Después elegimos la branch de "release":
			</p>
			<pre class="language-bash highlight">
<code>$ cd nuget-server
$ git checkout release
				</code>
</pre>
			<h3 id="configurando-nuget.server">
				Configurando NuGet.Server
			</h3>
			<p>
				Independientemente del camino elegido, llegamos al punto de tener que buscar el archivo de la solución "NuGet.Server.sln" y abrirlo con Visual Studio.
			</p>
			<p>
				<img src="/assets/uploads/2016/09/vs-nuget-1.png" alt="Solution Explorer: NuGet.Server" />
			</p>
			<p>
				Allí nos dirigiremos al archivo "Web.config", dentro de la sección "appSettings", a una línea que añade la clave "apiKey":
			</p>
			<p>
				<img src="/assets/uploads/2016/09/vs-nuget-2.png" alt="" apikey in web.config />
			</p>
			<p>
				Aquí deberemos sustituir el valor por el que más rabia nos dé. En mi caso puse: "yippee-ki-yay".
			</p>
			<p>
				Para terminar, publicaremos la solución en una WebApp de Azure. O si aun no tenemos una cuenta en la nube, la podremos publicar en forma de aplicación Web en cualquier IIS.
			</p>
			<p>
				Habíamos conseguido arreglar el día de navidad. Además con el bonus extra de tener que escribir en directo comandos en una ventana negra con texto blanquecino. ¡Brujería!
			</p>
			<p>
				<img src="/assets/uploads/2016/09/Fernando+ha+usado+brujer%C3%ADa.gif" alt="Logro desbloqueado: brujería" />
			</p>
			<h2 id="como-hago-que-visual-studio-use-mi-servidor-nuget">
				¿Cómo hago que Visual Studio use mi servidor NuGet?
			</h2>
			<p>
				Está claro que de nada sirve un servidor si nadie consume los servicios de los que provee. Pero que no cunda el pánico. Simplemente tendremos que abrir Visual Studio y navegar por el menú "tools" > "NuGet Package Manager" > "Package Manager Settings":
			</p>
			<p>
				<img src="/assets/uploads/2016/09/vs-add-nuget-server-1.png" alt="Package Manager Settings" />
			</p>
			<p>
				En la ventana que nos aparece elegiremos "Package Sources":
			</p>
			<p>
				<img src="/assets/uploads/2016/09/vs-add-nuget-server-2.png" alt="Package Sources" />
			</p>
			<p>
				Y pulsaremos el símbolo de "+" verde. Entonces nos aparecerá una línea nueva. En la parte inferior podremos cambiar su configuración:
			</p>
			<p>
				<img src="/assets/uploads/2016/09/vs-add-nuget-server-3.png" alt="Add package source" />
			</p>
			<p>
				En "Name" pondremos el nombre con el que queremos que aparezca nuestro servidor de NuGet. Y En "Source" pondremos la url de nuestro servidor de NuGet con un path a "/nuget". Entonces pulsaremos el botón de "Update" y después al botón de "OK".
			</p>
			<h2 id="como-publico-un-paquete-en-mi-servidor-nuget">
				¿Cómo publico un paquete en mi servidor NuGet?
			</h2>
			<p>
				Si configuramos nuestro servidor de NuGet en Visual Studio, pero no tenemos ningún paquete, pierde sentido todo este escrito. Pero podéis estar tranquilos. Publicar un paquete en nuestro servidor de NuGet es solo un comando:
			</p>
			<pre class="language-bash highlight">
<code>> nuget.exe push [My NuGet Package] [My NuGet Server] [My NuGet API Key]
				</code>
</pre>
			<p>
				Donde:
			</p>
			<p>
				-<strong>My NuGet Package
				</strong>: es la ruta a nuestro paquete de NuGet. Por ejemplo: "AGoodDayToDieHard.nupkg".
			</p>
			<p>
				-<strong>My NuGet Server
				</strong>: es la url de nuestro servidor de NuGet. Por ejemplo: "http://nuget.nakatomi.com".
			</p>
			<p>
				-<strong>My NuGet API Key
				</strong>: es el token que escribimos en las configuraciones del portal. En el archivo web.config. Por ejemplo: "yippee-ki-yay".
			</p>
			<h2 id="bonus-almacenar-los-paquetes-en-una-storage-account-de-azure">
				Bonus: almacenar los paquetes en una Storage Account de Azure
			</h2>
			<p>
				No os voy a desvelar todas los detalles, pero yo me fijaría en dos archivos del código fuente que os habéis descargado: NuGet.Server.Infrastructure.IServerPackageStore y NuGet.Server.IServiceResolver.
			</p>
			<h2 id="conclusiones">
				Conclusiones
			</h2>
			<p>
				No hay mucho más que añadir. NuGet es fácil. No es el mejor. Pero tampoco malo. Es útil. Y esto último no se puede decir de todas las herramientas que hay.
			</p>
			<p>
				Quien no tiene uno, es porque no quiere...
			</p>
			<p>
				<img src="/assets/uploads/2016/09/CncpsOKXEAAZ7VC.jpg" alt="Bricomanía - Briconsejo" />
			</p>
		</article>
		<section id="share">
			<a href="https://twitter.com/intent/tweet?text=Quiero mi propio NuGet&url=https://www.developerro.com/2016/09/08/quiero-mi-propio-nuget" rel="nofollow" target="_blank" title="Share on Twitter">
				<i class="fab fa-twitter">
				</i>
			</a> <a href="https://facebook.com/sharer.php?u=https://www.developerro.com/2016/09/08/quiero-mi-propio-nuget" rel="nofollow" target="_blank" title="Share on Facebook">
				<i class="fab fa-facebook"></i>
			</a> <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.developerro.com/2016/09/08/quiero-mi-propio-nuget" rel="nofollow" target="_blank" title="Share on Linkedlin">
				<i class="fab fa-linkedin"></i>
			</a> <a href="http://www.reddit.com/submit?url=https://www.developerro.com/2016/09/08/quiero-mi-propio-nuget" rel="nofollow" target="_blank" title="Share on Reddit">
				<i class="fab fa-reddit"></i>
			</a> <a href="https://www.buymeacoffee.com/fernandoescolar" rel="nofollow" target="_blank" title="Buy me a beer">
				<i class="fa fa-beer"></i> buy me a beer
			</a>
		</section>
		<section id="related">
			<h2>
				Relacionado (o no)
			</h2>
			<ul>
				<li>
					<a href="/2016/10/03/vsts-package-management">
						VSTS: Package Management
					</a> <small>03 oct. 2016
					</small>
				</li>
				<li>
					<a href="/2021/03/24/azure-functions-net-5">
						Azure Functions con .NET 5
					</a> <small>24 mar. 2021
					</small>
				</li>
				<li>
					<a href="/2021/03/10/efcore-vs-records">
						EF Core vs. Records
					</a> <small>10 mar. 2021
					</small>
				</li>
				<li>
					<a href="/video/2021/02/27/raiders-od-the-lost-leak">
						Raiders of the lost leak
					</a> <small>27 feb. 2021
					</small>
				</li>
				<li>
					<a href="/video/2020/12/09/net-5-just-talking">
						.Net 5 Just Talking
					</a> <small>09 dic. 2020
					</small>
				</li>
			</ul>
		</section>
		<footer>
			<ul>
				<li>
					<a href="mailto:fer.escolar@gmail.com" target="_blank">
						<i class="far fa-envelope">
						</i>
					</a>
				</li>
				<li>
					<a href="https://twitter.com/fernandoescolar" target="_blank">
						<i class="fab fa-twitter">
						</i>
					</a>
				</li>
				<li>
					<a href="https://www.linkedin.com/in/fernandoescolar" target="_blank">
						<i class="fab fa-linkedin">
						</i>
					</a>
				</li>
				<li>
					<a href="https://github.com/fernandoescolar" target="_blank">
						<i class="fab fa-github">
						</i>
					</a>
				</li>
				<li>
					<a href="https://www.buymeacoffee.com/fernandoescolar" target="_blank">
						<i class="fa fa-beer">
						</i>
					</a>
				</li>
			</ul><a href="https://creativecommons.org/licenses/by-sa/4.0" target="_blank">
				<img src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" />
			</a>
		</footer>
		<dialog id="cookie-notice">
			Nos gustaría usar cookies de terceros para hacer este sitio mejor. <a id="cookie-notice-accept">vale
			</a>
		</dialog>
		<script src="/assets/scripts.js">
		</script>
	</body>
</html>